# 生产环境配置示例
# 复制此文件为.env.production并修改实际值
# ⚠️ 警告：不要提交.env.production到Git仓库

# ==================== 应用配置 ====================
ENVIRONMENT=production
LOG_LEVEL=INFO
AUTO_CONVERT_TENSORRT=false

# ==================== 数据库配置 ====================
# ⚠️ 生产环境必须使用强密码
DATABASE_URL=postgresql://pyt_prod:CHANGE_ME_STRONG_PASSWORD@database:5432/pyt_production

# 或使用外部数据库
# DATABASE_URL=postgresql://user:password@prod-db.example.com:5432/dbname

# 数据库连接池配置
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ==================== Redis配置 ====================
# ⚠️ 生产环境必须使用强密码
REDIS_URL=redis://:CHANGE_ME_STRONG_PASSWORD@redis:6379/0

# 或使用外部Redis
# REDIS_URL=redis://:password@prod-redis.example.com:6379/0

# Redis连接池配置
REDIS_POOL_SIZE=10

# ==================== 领域服务配置 ====================
USE_DOMAIN_SERVICE=true
ROLLOUT_PERCENT=100
REPOSITORY_TYPE=postgresql

# ==================== API配置 ====================
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=false  # 生产环境禁用热重载

# Workers数量（推荐：CPU核心数 * 2 + 1）
# 例如4核：9个workers，8核：17个workers
GUNICORN_WORKERS=4
GUNICORN_TIMEOUT=120

# ==================== 安全配置 ====================
# ⚠️ 必须修改为强密码

# 管理员账号（建议修改用户名）
ADMIN_USERNAME=pepadmin
ADMIN_PASSWORD=CHANGE_ME_VERY_STRONG_PASSWORD_MIN_16_CHARS

# 应用密钥（生成方法：python -c "import secrets; print(secrets.token_urlsafe(64))"）
SECRET_KEY=CHANGE_ME_64_CHAR_RANDOM_KEY_USE_SECRETS_TOKEN_URLSAFE

# JWT配置
JWT_SECRET_KEY=CHANGE_ME_ANOTHER_64_CHAR_RANDOM_KEY
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ==================== 摄像头配置 ====================
CAMERAS_YAML_PATH=/app/config/cameras.yaml

# ==================== CORS配置 ====================
# 允许的域名（逗号分隔）
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com
CORS_ALLOW_CREDENTIALS=true

# ==================== 文件上传配置 ====================
MAX_UPLOAD_SIZE_MB=100
ALLOWED_UPLOAD_EXTENSIONS=jpg,jpeg,png,mp4,avi

# ==================== 监控配置 ====================
# Sentry（错误追踪）
SENTRY_DSN=https://xxx@sentry.io/xxx
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus（指标收集）
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# ==================== 日志配置 ====================
# 日志级别：DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
LOG_FORMAT=json  # 生产环境使用JSON格式便于日志聚合

# 日志文件
LOG_FILE=/app/logs/app.log
LOG_MAX_BYTES=104857600  # 100MB
LOG_BACKUP_COUNT=10

# ==================== 邮件配置（可选） ====================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@example.com
SMTP_PASSWORD=CHANGE_ME
SMTP_FROM=noreply@example.com
SMTP_TLS=true

# ==================== 备份配置（可选） ====================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 每天凌晨2点
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=my-backups
BACKUP_S3_REGION=us-west-2

# ==================== 性能优化 ====================
# 启用生产优化
PRODUCTION_MODE=true
ENABLE_GZIP=true
ENABLE_CACHE=true
CACHE_TTL_SECONDS=300

# ==================== 特性开关 ====================
# 可以通过环境变量动态开关特性
FEATURE_NEW_UI=true
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_REAL_TIME_ALERTS=true

# ==================== 外部服务（可选） ====================
# AWS配置
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-west-2
AWS_S3_BUCKET=

# 对象存储
OBJECT_STORAGE_URL=
OBJECT_STORAGE_ACCESS_KEY=
OBJECT_STORAGE_SECRET_KEY=

# ==================== 高级配置 ====================
# 时区
TZ=UTC

# 语言
LANGUAGE=zh_CN

# 调试（生产环境应为false）
DEBUG=false
TESTING=false

# ==================== 备注 ====================
# 1. 所有密码必须修改为强密码
# 2. SECRET_KEY必须使用随机生成的密钥
# 3. 不要提交此文件到Git
# 4. 定期轮换密码和密钥
# 5. 使用密钥管理服务（如AWS Secrets Manager）更安全
