# å¼€å‘ç¯å¢ƒé‡å»ºæ€»ç»“æŠ¥å‘Š

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†é¡¹ç›®é‡å‘½ååå¼€å‘ç¯å¢ƒé‡å»ºçš„å®Œæ•´è¿‡ç¨‹ã€‚

**é‡å»ºæ—¥æœŸ**: 2025-11-25  
**é¡¹ç›®åç§°**: Pyt â†’ pepGMP  
**é‡å»ºåŸå› **: é¡¹ç›®é‡å‘½ååéœ€è¦æ›´æ–°æ‰€æœ‰Dockerå®¹å™¨å’Œé…ç½®

---

## âœ… ä¸€ã€é‡å»ºæ­¥éª¤

### 1.1 æ•°æ®å¤‡ä»½ âœ…

**æ‰§è¡Œæ—¶é—´**: 2025-11-25 13:23-13:33

**å¤‡ä»½å†…å®¹**:
- âœ… PostgreSQLæ•°æ®åº“å¤‡ä»½
  - å¤‡ä»½æ–‡ä»¶: `backups/dev/db/backup_pyt_development_20251125_133358.sql.gz`
  - æ–‡ä»¶å¤§å°: 4.0MB
  - æ•°æ®åº“: `pyt_development` (æ—§åç§°)
- âœ… Redisæ•°æ®å¤‡ä»½
  - å¤‡ä»½æ–‡ä»¶: `backups/dev/redis/backup_redis_20251125_133358.rdb`
  - æ–‡ä»¶å¤§å°: 88B
- âœ… Dockerå·å¤‡ä»½
  - PostgreSQLå·: `backups/dev/volumes/postgres_dev_data_20251125_133358.tar.gz`
  - Rediså·: `backups/dev/volumes/redis_dev_data_20251125_133358.tar.gz`

**å¤‡ä»½è„šæœ¬**: `scripts/backup_dev_data.sh`

---

### 1.2 åœæ­¢æ—§å®¹å™¨ âœ…

**æ‰§è¡Œæ“ä½œ**:
- âœ… åœæ­¢æ‰€æœ‰æ—§å®¹å™¨ï¼ˆpyt-postgres-dev, pyt-redis-devç­‰ï¼‰
- âœ… æ¸…ç†æ—§ç½‘ç»œï¼ˆpyt-dev-networkï¼‰
- âœ… ä¿ç•™Dockerå·æ•°æ®ï¼ˆpostgres_dev_data, redis_dev_dataï¼‰

**æ—§å®¹å™¨åç§°**:
- `pyt-postgres-dev`
- `pyt-redis-dev`
- `pyt-api-dev`
- `pyt-frontend-dev`

---

### 1.3 ä¿®å¤Dockerfile âœ…

**é—®é¢˜**: `libatlas-base-dev` åŒ…åœ¨Debian Trixieä¸­ä¸å¯ç”¨

**ä¿®å¤**:
- âœ… å°† `libatlas-base-dev` æ›¿æ¢ä¸º `libopenblas-dev`
- âœ… æ–‡ä»¶: `Dockerfile.dev`

---

### 1.4 é‡æ–°æ„å»ºå®¹å™¨ âœ…

**æ–°å®¹å™¨åç§°**:
- `pepgmp-postgres-dev` (PostgreSQLæ•°æ®åº“)
- `pepgmp-redis-dev` (Redisç¼“å­˜)
- `pepgmp-api-dev` (åç«¯API)
- `pepgmp-frontend-dev` (å‰ç«¯)

**æ–°ç½‘ç»œåç§°**:
- `pepgmp-dev-network`

**æ–°æ•°æ®åº“é…ç½®**:
- æ•°æ®åº“å: `pepgmp_development`
- ç”¨æˆ·å: `pepgmp_dev`
- å¯†ç : `pepgmp_dev_password`

**æ‰§è¡Œå‘½ä»¤**:
```bash
docker compose build api
docker compose up -d
```

---

### 1.5 æ•°æ®æ¢å¤ âœ…

**æ¢å¤è¿‡ç¨‹**:
1. âœ… æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–ï¼ˆé€šè¿‡init_db.sqlï¼‰
2. âœ… ä»å¤‡ä»½æ¢å¤æ•°æ®
   - æºæ•°æ®åº“: `pyt_development`
   - ç›®æ ‡æ•°æ®åº“: `pepgmp_development`
   - æ¢å¤è„šæœ¬: `scripts/restore_dev_data.sh`

**æ¢å¤è„šæœ¬æ›´æ–°**:
- âœ… æ”¯æŒä»æ—§æ•°æ®åº“åï¼ˆpyt_developmentï¼‰æ¢å¤
- âœ… æ”¯æŒéäº¤äº’å¼æ¨¡å¼ï¼ˆSKIP_CONFIRMç¯å¢ƒå˜é‡ï¼‰

---

### 1.6 æœåŠ¡å¯åŠ¨éªŒè¯ âœ…

**æœåŠ¡çŠ¶æ€**:
- âœ… PostgreSQL: è¿è¡Œä¸­ï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… Redis: è¿è¡Œä¸­ï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… API: è¿è¡Œä¸­ï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… Frontend: è¿è¡Œä¸­

**éªŒè¯ç»“æœ**:
- âœ… APIå¥åº·æ£€æŸ¥: `http://localhost:8000/health` â†’ `{"status":"healthy"}`
- âœ… æ•°æ®åº“è¿æ¥: æ­£å¸¸
- âœ… Redisè¿æ¥: æ­£å¸¸

---

## ğŸ“Š äºŒã€é…ç½®å˜æ›´å¯¹æ¯”

### 2.1 å®¹å™¨åç§°å˜æ›´

| æœåŠ¡ | æ—§åç§° | æ–°åç§° |
|------|--------|--------|
| PostgreSQL | `pyt-postgres-dev` | `pepgmp-postgres-dev` |
| Redis | `pyt-redis-dev` | `pepgmp-redis-dev` |
| API | `pyt-api-dev` | `pepgmp-api-dev` |
| Frontend | `pyt-frontend-dev` | `pepgmp-frontend-dev` |

### 2.2 ç½‘ç»œåç§°å˜æ›´

| ç±»å‹ | æ—§åç§° | æ–°åç§° |
|------|--------|--------|
| ç½‘ç»œ | `pyt-dev-network` | `pepgmp-dev-network` |

### 2.3 æ•°æ®åº“é…ç½®å˜æ›´

| é…ç½®é¡¹ | æ—§å€¼ | æ–°å€¼ |
|--------|------|------|
| æ•°æ®åº“å | `pyt_development` | `pepgmp_development` |
| ç”¨æˆ·å | `pyt_dev` | `pepgmp_dev` |
| å¯†ç  | `pyt_dev_password` | `pepgmp_dev_password` |

---

## ğŸ”§ ä¸‰ã€åˆ›å»ºçš„è„šæœ¬

### 3.1 å¤‡ä»½è„šæœ¬

**æ–‡ä»¶**: `scripts/backup_dev_data.sh`

**åŠŸèƒ½**:
- å¤‡ä»½PostgreSQLæ•°æ®åº“
- å¤‡ä»½Redisæ•°æ®
- å¤‡ä»½Dockerå·
- è‡ªåŠ¨æ£€æµ‹æ–°æ—§å®¹å™¨åç§°
- ç”Ÿæˆå¤‡ä»½ä¿¡æ¯æ–‡ä»¶

**ä½¿ç”¨**:
```bash
bash scripts/backup_dev_data.sh [å¤‡ä»½ç›®å½•]
```

---

### 3.2 æ¢å¤è„šæœ¬

**æ–‡ä»¶**: `scripts/restore_dev_data.sh`

**åŠŸèƒ½**:
- ä»å¤‡ä»½æ¢å¤PostgreSQLæ•°æ®åº“
- ä»å¤‡ä»½æ¢å¤Redisæ•°æ®
- æ”¯æŒä»æ—§æ•°æ®åº“åæ¢å¤
- æ”¯æŒéäº¤äº’å¼æ¨¡å¼

**ä½¿ç”¨**:
```bash
# äº¤äº’å¼
bash scripts/restore_dev_data.sh [å¤‡ä»½ç›®å½•] [æ—¶é—´æˆ³]

# éäº¤äº’å¼
SKIP_CONFIRM=yes bash scripts/restore_dev_data.sh [å¤‡ä»½ç›®å½•] [æ—¶é—´æˆ³]
```

---

### 3.3 é‡å»ºè„šæœ¬

**æ–‡ä»¶**: `scripts/rebuild_dev_environment.sh`

**åŠŸèƒ½**:
- åœæ­¢æ—§å®¹å™¨
- æ¸…ç†æ—§ç½‘ç»œ
- é‡æ–°æ„å»ºé•œåƒ
- å¯åŠ¨æ–°å®¹å™¨
- æ¢å¤æ•°æ®ï¼ˆå¯é€‰ï¼‰

**ä½¿ç”¨**:
```bash
bash scripts/rebuild_dev_environment.sh [å¤‡ä»½ç›®å½•] [æ—¶é—´æˆ³]
```

---

## âš ï¸ å››ã€é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 4.1 Dockerfileæ„å»ºå¤±è´¥

**é—®é¢˜**: `libatlas-base-dev` åŒ…åœ¨Debian Trixieä¸­ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**: æ›¿æ¢ä¸º `libopenblas-dev`

**æ–‡ä»¶**: `Dockerfile.dev`

---

### 4.2 æ•°æ®åº“ç”¨æˆ·ä¸å­˜åœ¨

**é—®é¢˜**: æ¢å¤æ•°æ®æ—¶æç¤ºç”¨æˆ·ä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**: 
- PostgreSQLå®¹å™¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºç”¨æˆ·ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ï¼‰
- å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨åˆ›å»º

---

### 4.3 å¤‡ä»½æ–‡ä»¶å‘½å

**é—®é¢˜**: å¤‡ä»½æ–‡ä»¶ä½¿ç”¨æ—§æ•°æ®åº“åï¼ˆpyt_developmentï¼‰

**è§£å†³æ–¹æ¡ˆ**: 
- æ¢å¤è„šæœ¬æ”¯æŒè‡ªåŠ¨æ£€æµ‹æ–°æ—§æ•°æ®åº“å
- å¯ä»¥ä»æ—§æ•°æ®åº“åå¤‡ä»½æ¢å¤

---

## ğŸ“ äº”ã€éªŒè¯æ¸…å•

### 5.1 å®¹å™¨çŠ¶æ€ âœ…

- [x] æ‰€æœ‰å®¹å™¨è¿è¡Œæ­£å¸¸
- [x] å¥åº·æ£€æŸ¥é€šè¿‡
- [x] ç«¯å£æ˜ å°„æ­£ç¡®

### 5.2 æ•°æ®å®Œæ•´æ€§ âœ…

- [x] æ•°æ®åº“è¡¨ç»“æ„å®Œæ•´
- [x] æ•°æ®æ¢å¤æˆåŠŸ
- [x] Redisæ•°æ®æ­£å¸¸

### 5.3 æœåŠ¡åŠŸèƒ½ âœ…

- [x] APIå¥åº·æ£€æŸ¥æ­£å¸¸
- [x] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [x] Redisè¿æ¥æ­£å¸¸
- [x] å‰ç«¯æœåŠ¡æ­£å¸¸

---

## ğŸš€ å…­ã€åç»­æ­¥éª¤

### 6.1 å¼€å‘ç¯å¢ƒä½¿ç”¨

**å¯åŠ¨æœåŠ¡**:
```bash
docker compose up -d
```

**æŸ¥çœ‹æ—¥å¿—**:
```bash
docker compose logs -f
```

**åœæ­¢æœåŠ¡**:
```bash
docker compose down
```

**è®¿é—®æœåŠ¡**:
- å‰ç«¯: http://localhost:5173
- API: http://localhost:8000
- APIæ–‡æ¡£: http://localhost:8000/docs

---

### 6.2 æ•°æ®å¤‡ä»½å»ºè®®

**å®šæœŸå¤‡ä»½**:
```bash
# æ¯å¤©å¤‡ä»½
bash scripts/backup_dev_data.sh ./backups/dev
```

**å¤‡ä»½ä¿ç•™ç­–ç•¥**:
- å¼€å‘ç¯å¢ƒ: ä¿ç•™æœ€è¿‘7å¤©
- ç”Ÿäº§ç¯å¢ƒ: ä¿ç•™æœ€è¿‘30å¤©

---

### 6.3 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**æ³¨æ„äº‹é¡¹**:
1. ç”Ÿäº§ç¯å¢ƒéœ€è¦å•ç‹¬å¤‡ä»½
2. ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆdocker-compose.prod.ymlï¼‰
3. ç¡®ä¿Registryé…ç½®æ­£ç¡®
4. éªŒè¯ç½‘ç»œè¿æ¥

**éƒ¨ç½²å‘½ä»¤**:
```bash
bash scripts/quick_deploy.sh <SERVER_IP> ubuntu
```

---

## ğŸ“š ä¸ƒã€ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®é‡å‘½åå½±å“åˆ†æ](./PROJECT_RENAME_IMPACT_ANALYSIS.md)
- [éƒ¨ç½²æµç¨‹æŒ‡å—](./DEPLOYMENT_PROCESS_GUIDE.md)
- [éƒ¨ç½²å‰æ£€æŸ¥æŠ¥å‘Š](./PRE_DEPLOYMENT_CHECK_REPORT.md)

---

**çŠ¶æ€**: âœ… **å¼€å‘ç¯å¢ƒé‡å»ºå®Œæˆ**  
**æ‰€æœ‰æœåŠ¡**: âœ… **è¿è¡Œæ­£å¸¸**  
**æ•°æ®**: âœ… **æ¢å¤æˆåŠŸ**  
**ä¸‹ä¸€æ­¥**: å¯ä»¥å¼€å§‹æ­£å¸¸å¼€å‘å·¥ä½œ

---

**é‡å»ºå®Œæˆæ—¥æœŸ**: 2025-11-25  
**é‡å»ºè€—æ—¶**: çº¦30åˆ†é’Ÿ  
**å¤‡ä»½ä½ç½®**: `./backups/dev/`

