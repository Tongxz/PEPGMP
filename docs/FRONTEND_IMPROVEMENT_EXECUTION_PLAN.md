# 前端功能完善执行计划

## 📋 执行计划概览

本执行计划基于《前端功能完善需求清单》，按照优先级分阶段实施。

---

## 🎯 第一阶段：P0 紧急任务（必须立即实现）

### 目标
修复所有假数据问题，确保所有页面显示真实数据。

### 预计时间
**2-3 天**

---

### 任务 1.1：实现智能检测实时统计接口（后端）

**优先级**: 🔴 P0 - 紧急

**任务描述**:
- 实现 `GET /statistics/detection-realtime` 接口
- 返回智能检测面板所需的实时统计数据

**技术实现**:
- 文件: `src/api/routers/statistics.py`
- 复用现有统计逻辑，扩展返回数据
- 包含：处理效率、FPS、帧数、场景分布、性能监控等

**验收标准**:
- ✅ 接口返回完整的数据结构
- ✅ 数据实时更新（可考虑缓存机制）
- ✅ 接口响应时间 < 500ms
- ✅ 包含错误处理

**依赖**: 无

**预计工作量**: 0.5-1 天

---

### 任务 1.2：修复首页智能检测面板（前端）

**优先级**: 🔴 P0 - 紧急

**任务描述**:
- 修复 `IntelligentDetectionPanelSimple.vue` 组件
- 移除所有硬编码数据
- 调用新的实时统计接口

**技术实现**:
- 文件: `frontend/src/components/IntelligentDetectionPanelSimple.vue`
- 添加 API 调用逻辑
- 添加加载状态和错误处理
- 添加自动刷新机制（可选）

**修改内容**:
1. 导入 `statisticsApi` 和必要的 composables
2. 添加响应式数据状态
3. 实现数据获取函数
4. 替换所有硬编码数据为动态数据
5. 添加加载和错误状态显示

**验收标准**:
- ✅ 所有数据来自接口，无硬编码
- ✅ 显示加载状态
- ✅ 错误时显示友好提示
- ✅ 数据实时更新（建议 30 秒刷新一次）

**依赖**: 任务 1.1（后端接口）

**预计工作量**: 0.5 天

---

### 任务 1.3：修复检测记录页面摄像头选项（前端）

**优先级**: 🔴 P0 - 紧急

**任务描述**:
- 修复 `DetectionRecords.vue` 中的硬编码摄像头选项
- 动态获取摄像头列表

**技术实现**:
- 文件: `frontend/src/views/DetectionRecords.vue`
- 使用 `cameraStore.fetchCameras()` 获取摄像头列表
- 动态生成选项

**修改内容**:
1. 导入 `useCameraStore`
2. 移除硬编码的 `cameraOptions`（第237-241行）
3. 使用 `computed` 动态生成选项
4. 在 `onMounted` 中调用 `fetchCameras()`

**验收标准**:
- ✅ 摄像头选项从接口动态获取
- ✅ 新增/删除摄像头后选项自动更新
- ✅ 默认选中第一个可用摄像头（如果存在）

**依赖**: 无（使用现有接口）

**预计工作量**: 0.25 天

---

## 🎯 第二阶段：P1 重要任务（建议尽快实现）

### 目标
完善告警中心功能，提升用户体验和性能。

### 预计时间
**2-4 天**

---

### 任务 2.1：增强告警历史接口（后端）

**优先级**: 🟡 P1 - 重要

**任务描述**:
- 为 `GET /alerts/history-db` 接口添加分页和排序支持

**技术实现**:
- 文件: `src/api/routers/alerts.py`
- 添加分页参数：`limit`, `offset`, `page`
- 添加排序参数：`sort_by`, `sort_order`
- 返回总记录数和分页信息

**修改内容**:
1. 添加分页参数解析
2. 添加排序参数解析
3. 修改数据库查询逻辑
4. 返回格式：`{ items, total, limit, offset, page?, total_pages? }`

**验收标准**:
- ✅ 支持分页参数
- ✅ 支持排序参数（timestamp, camera_id, alert_type）
- ✅ 返回总记录数
- ✅ 性能优化（大数据量时）

**依赖**: 无

**预计工作量**: 0.5-1 天

---

### 任务 2.2：增强告警规则接口（后端）

**优先级**: 🟡 P1 - 重要

**任务描述**:
- 为 `GET /alerts/rules` 接口添加分页支持

**技术实现**:
- 文件: `src/api/routers/alerts.py`
- 添加分页参数
- 返回分页信息

**验收标准**:
- ✅ 支持分页参数
- ✅ 返回总记录数

**依赖**: 无

**预计工作量**: 0.25-0.5 天

---

### 任务 2.3：实现告警中心分页功能（前端）

**优先级**: 🟡 P1 - 重要

**任务描述**:
- 为告警历史表格添加分页功能
- 为告警规则表格添加分页功能

**技术实现**:
- 文件: `frontend/src/views/Alerts.vue`
- 添加分页状态管理
- 修改 `fetchHistory` 和 `fetchRules` 方法
- 添加分页组件

**修改内容**:
1. 添加分页状态（page, pageSize, total）
2. 修改查询方法传递分页参数
3. 更新响应数据处理
4. 添加分页组件到表格

**验收标准**:
- ✅ 告警历史表格支持分页
- ✅ 告警规则表格支持分页
- ✅ 分页信息正确显示
- ✅ 切换页码时正确加载数据

**依赖**: 任务 2.1, 2.2（后端接口）

**预计工作量**: 0.5-1 天

---

### 任务 2.4：实现告警中心排序功能（前端）

**优先级**: 🟡 P1 - 重要

**任务描述**:
- 为告警历史表格添加后端排序支持
- 移除前端排序逻辑

**技术实现**:
- 文件: `frontend/src/views/Alerts.vue`
- 添加排序状态管理
- 修改查询方法传递排序参数
- 移除前端排序代码（第313-316行）

**修改内容**:
1. 添加排序状态（sortBy, sortOrder）
2. 修改 `fetchHistory` 传递排序参数
3. 移除前端排序逻辑
4. 添加排序UI控件（可选）

**验收标准**:
- ✅ 排序由后端处理
- ✅ 支持多字段排序
- ✅ 排序方向可切换
- ✅ 大数据量时性能良好

**依赖**: 任务 2.1（后端接口）

**预计工作量**: 0.25-0.5 天

---

## 🎯 第三阶段：P2 可选任务（根据需求实现）

### 目标
功能增强和性能优化。

### 预计时间
**根据需求确定**

---

### 任务 3.1：检测记录详情接口（后端，可选）

**优先级**: 🟢 P2 - 可选

**任务描述**:
- 实现 `GET /records/detection-records/{record_id}` 接口
- 返回检测记录的详细信息

**预计工作量**: 0.5 天

---

### 任务 3.2：违规记录详情接口（后端，可选）

**优先级**: 🟢 P2 - 可选

**任务描述**:
- 实现 `GET /records/violations/{violation_id}` 接口
- 返回违规记录的详细信息

**预计工作量**: 0.5 天

---

### 任务 3.3：检测记录添加更多筛选条件（前端，可选）

**优先级**: 🟢 P2 - 可选

**任务描述**:
- 为检测记录页面添加更多筛选条件
- 置信度范围、处理时间范围、对象数量等

**预计工作量**: 1 天

---

### 任务 3.4：统计分析添加更多图表类型（前端，可选）

**优先级**: 🟢 P2 - 可选

**任务描述**:
- 为统计页面添加更多图表类型
- 时间序列图、热力图、散点图、雷达图等

**预计工作量**: 2-3 天

---

### 任务 3.5：数据自动刷新机制（前端，可选）

**优先级**: 🟢 P2 - 可选

**任务描述**:
- 为需要实时数据的页面添加自动刷新
- 可配置刷新间隔
- 支持暂停/继续

**预计工作量**: 1-2 天

---

## 📊 执行时间表

### 第一周

| 日期 | 任务 | 负责人 | 状态 |
|------|------|--------|------|
| Day 1 | 任务 1.1: 实现智能检测实时统计接口（后端） | 后端开发 | ⏳ 待开始 |
| Day 1-2 | 任务 1.2: 修复首页智能检测面板（前端） | 前端开发 | ⏳ 待开始 |
| Day 2 | 任务 1.3: 修复检测记录页面摄像头选项（前端） | 前端开发 | ⏳ 待开始 |

### 第二周

| 日期 | 任务 | 负责人 | 状态 |
|------|------|--------|------|
| Day 1 | 任务 2.1: 增强告警历史接口（后端） | 后端开发 | ⏳ 待开始 |
| Day 1-2 | 任务 2.2: 增强告警规则接口（后端） | 后端开发 | ⏳ 待开始 |
| Day 2-3 | 任务 2.3: 实现告警中心分页功能（前端） | 前端开发 | ⏳ 待开始 |
| Day 3-4 | 任务 2.4: 实现告警中心排序功能（前端） | 前端开发 | ⏳ 待开始 |

### 第三周及以后

根据实际需求选择实现 P2 优先级任务。

---

## ✅ 验收标准

### 第一阶段验收

- [ ] 首页智能检测面板显示真实数据
- [ ] 检测记录页面摄像头选项动态获取
- [ ] 所有假数据问题已修复
- [ ] 接口响应时间符合要求
- [ ] 错误处理完善

### 第二阶段验收

- [ ] 告警历史支持分页
- [ ] 告警规则支持分页
- [ ] 告警历史支持后端排序
- [ ] 大数据量时性能良好
- [ ] UI交互流畅

---

## 📝 注意事项

1. **代码规范**: 所有代码修改必须符合项目开发规范
2. **测试**: 每个任务完成后需要进行功能测试
3. **文档**: 重要接口需要更新API文档
4. **兼容性**: 确保修改不影响现有功能
5. **性能**: 注意大数据量时的性能优化

---

## 🔄 更新日志

- **2025-XX-XX**: 创建执行计划

---

**文档版本**: v1.0.0
**最后更新**: 2025年

