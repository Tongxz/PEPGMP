# 前端违规数据查看指南

## 📍 违规数据查看位置

### 主要查看页面

**页面路径**: `/detection-records`
**页面名称**: 检测历史记录
**文件位置**: `frontend/src/views/DetectionRecords.vue`

### 页面结构

该页面包含两个主要部分：

#### 1. 📊 检测历史记录（上半部分）

- **功能**: 显示检测记录列表
- **筛选条件**:
  - 摄像头选择
  - 时间范围选择
- **显示内容**:
  - 检测记录ID
  - 时间戳
  - 帧号
  - 人数
  - 发网违规数
  - 洗手事件数
  - 消毒事件数
  - FPS
  - 处理时间
  - 操作（查看详情）

#### 2. 🚨 违规事件记录（下半部分）⭐ **违规数据在这里查看**

- **功能**: 显示所有违规事件记录
- **筛选条件**:
  - 违规状态筛选（待处理、已确认、误报、已解决）
  - 违规类型筛选（未戴发网、未洗手、未消毒）
  - 摄像头筛选（通过上方的摄像头选择器）
- **显示内容**:
  - 违规ID
  - 时间戳
  - 摄像头ID
  - 违规类型（带颜色标签）
  - 置信度
  - 状态（带颜色标签）
  - 跟踪ID
  - 操作（更新状态）

### 访问方式

#### 方式1：通过导航菜单

1. 打开前端应用（通常是 `http://localhost:5173`）
2. 在左侧导航菜单中找到 **"检测历史记录"** 或 **"Detection Records"**
3. 点击进入页面
4. 向下滚动到 **"🚨 违规事件记录"** 卡片区域

#### 方式2：直接访问URL

```
http://localhost:5173/detection-records
```

### 页面功能详解

#### 违规记录筛选

1. **违规状态筛选**：
   - 全部状态
   - 待处理 (pending)
   - 已确认 (confirmed)
   - 误报 (false_positive)
   - 已解决 (resolved)

2. **违规类型筛选**：
   - 全部类型
   - 未戴发网 (no_hairnet)
   - 未洗手 (no_handwash)
   - 未消毒 (no_sanitize)

3. **摄像头筛选**：
   - 通过页面上方的摄像头选择器
   - 选择特定摄像头后，违规记录会自动筛选

#### 违规记录操作

1. **查看违规记录**：
   - 在违规记录表格中查看所有违规事件
   - 表格支持分页显示

2. **更新违规状态**：
   - 点击"更新状态"按钮
   - 在弹出的对话框中选择新状态
   - 确认后更新违规记录状态

#### 违规记录显示字段

- **ID**: 违规事件唯一标识
- **时间**: 违规发生的时间
- **摄像头**: 检测到违规的摄像头ID
- **违规类型**:
  - 未戴发网 (红色标签)
  - 未洗手 (黄色标签)
  - 未消毒 (蓝色标签)
- **置信度**: 违规检测的置信度（百分比）
- **状态**:
  - 待处理 (黄色标签)
  - 已确认 (红色标签)
  - 误报 (灰色标签)
  - 已解决 (绿色标签)
- **跟踪ID**: 关联的对象跟踪ID

### 数据刷新

- **自动刷新**: 页面加载时自动加载违规记录
- **手动刷新**: 点击"查询违规"按钮刷新数据
- **筛选刷新**: 更改筛选条件后自动刷新

### API调用

违规数据通过以下API获取：

```
GET /api/v1/records/violations
```

**查询参数**:
- `limit`: 每页数量（默认50）
- `offset`: 偏移量（默认0）
- `camera_id`: 摄像头ID（可选）
- `status`: 状态筛选（可选）
- `violation_type`: 违规类型筛选（可选）

### 注意事项

1. **违规类型映射**：
   - 前端显示的违规类型可能不包括所有后端检测到的类型
   - 当前前端只支持：`no_hairnet`、`no_handwash`、`no_sanitize`
   - 如果后端检测到其他类型（如 `no_safety_helmet`、`no_safety_vest`），会显示原始类型名称

2. **数据实时性**：
   - 违规数据不是实时更新的
   - 需要手动刷新或重新加载页面才能看到最新数据

3. **分页**：
   - 违规记录支持分页显示
   - 可以通过分页控件翻页查看更多记录

### 其他相关页面

虽然违规数据主要在"检测历史记录"页面查看，但其他页面也可能显示违规相关信息：

1. **统计分析页面** (`/statistics`):
   - 显示违规统计数据
   - 显示违规趋势图表

2. **告警中心页面** (`/alerts`):
   - 显示告警信息（可能包含违规告警）
   - 告警规则管理

### 截图说明

页面布局：

```
┌─────────────────────────────────────────┐
│  📊 检测历史记录                          │
│  ┌───────────────────────────────────┐  │
│  │ 筛选器（摄像头、时间范围）          │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │ 统计卡片（总帧数、人数、违规数等）  │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │ 检测记录表格                        │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  🚨 违规事件记录 ⭐                      │
│  ┌───────────────────────────────────┐  │
│  │ 筛选器（状态、类型）                │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │ 违规记录表格                        │  │
│  │ - ID、时间、摄像头                  │  │
│  │ - 违规类型、置信度                  │  │
│  │ - 状态、跟踪ID                      │  │
│  │ - 操作（更新状态）                  │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

---

**文档版本**: 1.0
**最后更新**: 2024-11-05
**页面路径**: `/detection-records`
**文件位置**: `frontend/src/views/DetectionRecords.vue`
