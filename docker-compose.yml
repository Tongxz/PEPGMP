version: "3.8"

services:
  # 开发模式下的应用服务
  app-dev:
    build:
      context: .
      # 使用开发专用的Dockerfile.dev
      dockerfile: Dockerfile.dev
    container_name: hbd-app-dev
    ports:
      - "8000:8000"
    volumes:
      # 挂载所有代码和配置，实现热重载
      - .:/app
    environment:
      - PYTHONPATH=/app
      - LOG_LEVEL=DEBUG
      - ENVIRONMENT=development
    # 开发模式下，直接在命令行启动，方便查看日志
    command: python main.py --mode api --host 0.0.0.0 --debug
    networks:
      - hbd-network
    # 为开发环境配置GPU (如果需要)
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

networks:
  hbd-network:
    driver: bridge
